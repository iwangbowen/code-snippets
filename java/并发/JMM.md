# Java内存模型

## FAQs

### 1. cpu不是有内存一致性协议吗，为什么java仍然有volatile关键字保证可见性?

CPU的内存一致性协议确实可以在一定程度上保证内存的可见性，但这并不足以满足所有的并发编程需求。这是因为在现代的计算机系统中，除了CPU的缓存之外，还有很多其他的因素可以影响内存的可见性，例如编译器的优化。

Java的volatile关键字提供了一种更高级别的内存可见性保证。当一个字段被声明为volatile时，Java内存模型将确保所有线程都能看到这个字段的最新值，无论CPU的缓存如何，无论编译器的优化如何。

此外，volatile关键字还有一个重要的特性，那就是禁止指令重排序。在没有同步的情况下，编译器、处理器为了提高性能，可能会对输入代码进行重排序。但是，如果对volatile变量的读写，Java内存模型确保不会被重排序。

因此，尽管CPU有内存一致性协议，但在并发编程中，我们仍然需要像volatile这样的工具来提供更强的内存可见性和顺序性保证。
